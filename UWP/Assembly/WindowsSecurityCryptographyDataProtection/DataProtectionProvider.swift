// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Represents a cryptographic provider that can be used to asynchronously encrypt and decrypt static data or a data stream.
public final class WindowsSecurityCryptographyDataProtection_DataProtectionProvider: WindowsRuntime.WinRTImport<WindowsSecurityCryptographyDataProtection_DataProtectionProviderProjection> {
    // MARK: IActivationFactory members

    public convenience init() throws {
        self.init(_transferringRef: try Self._iactivationFactory.activateInstance(projection: WindowsSecurityCryptographyDataProtection_DataProtectionProviderProjection.self))
    }

    // MARK: Windows.Security.Cryptography.DataProtection.IDataProtectionProviderFactory members

    public convenience init(_ protectionDescriptor: Swift.String) throws {
        self.init(_transferringRef: try COM.NullResult.unwrap(Self._idataProtectionProviderFactory.createOverloadExplicit(protectionDescriptor)))
    }

    // MARK: Windows.Security.Cryptography.DataProtection.IDataProtectionProvider members

    /// Asynchronously protects static data.
    /// - Parameter data: Data to protect.
    /// - Returns: Represents an asynchronous operation.
    public func protectAsync(_ data: WindowsStorageStreams_IBuffer?) throws -> WindowsFoundation_IAsyncOperation<WindowsStorageStreams_IBuffer?> {
        try COM.NullResult.unwrap(_interop.protectAsync(data))
    }

    /// Asynchronously decrypts static data.
    /// - Parameter data: Data to decrypt.
    /// - Returns: Represents an asynchronous operation.
    public func unprotectAsync(_ data: WindowsStorageStreams_IBuffer?) throws -> WindowsFoundation_IAsyncOperation<WindowsStorageStreams_IBuffer?> {
        try COM.NullResult.unwrap(_interop.unprotectAsync(data))
    }

    /// Asynchronously protects a data stream.
    /// - Parameter src: Stream to be protected.
    /// - Parameter dest: Protected stream.
    /// - Returns: Represents an asynchronous action.
    public func protectStreamAsync(_ src: WindowsStorageStreams_IInputStream?, _ dest: WindowsStorageStreams_IOutputStream?) throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.protectStreamAsync(src, dest))
    }

    /// Asynchronously decrypts a data stream.
    /// - Parameter src: Stream to decrypt.
    /// - Parameter dest: Decrypted stream.
    /// - Returns: Represents an asynchronous action.
    public func unprotectStreamAsync(_ src: WindowsStorageStreams_IInputStream?, _ dest: WindowsStorageStreams_IOutputStream?) throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.unprotectStreamAsync(src, dest))
    }

    // MARK: Implementation details

    private static var _iactivationFactory_storage: COM.COMInterop<CWinRT.SWRT_IActivationFactory>? = nil

    internal static var _iactivationFactory: COM.COMInterop<CWinRT.SWRT_IActivationFactory> {
        get throws {
            try _iactivationFactory_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.Security.Cryptography.DataProtection.DataProtectionProvider", id: CWinRT.SWRT_IActivationFactory.iid)
            }
        }
    }

    private static var _idataProtectionProviderFactory_storage: COM.COMInterop<CWinRT.SWRT_WindowsSecurityCryptographyDataProtection_IDataProtectionProviderFactory>? = nil

    internal static var _idataProtectionProviderFactory: COM.COMInterop<CWinRT.SWRT_WindowsSecurityCryptographyDataProtection_IDataProtectionProviderFactory> {
        get throws {
            try _idataProtectionProviderFactory_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.Security.Cryptography.DataProtection.DataProtectionProvider", id: CWinRT.SWRT_WindowsSecurityCryptographyDataProtection_IDataProtectionProviderFactory.iid)
            }
        }
    }
}