// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Represents a session of the USSD network protocol.
public final class WindowsNetworkingNetworkOperators_UssdSession: WindowsRuntime.WinRTImport<WindowsNetworkingNetworkOperators_UssdSessionProjection> {
    // MARK: Windows.Networking.NetworkOperators.IUssdSession members

    /// Sends a message to a USSD session and returns a handler to retrieve the reply asynchronously.
    /// - Parameter message: The message to send to the USSD session.
    /// - Returns: An asynchronous handler to retrieve the USSD response to the sent message.
    public func sendMessageAndGetReplyAsync(_ message: WindowsNetworkingNetworkOperators_UssdMessage?) throws -> WindowsFoundation_IAsyncOperation<WindowsNetworkingNetworkOperators_UssdReply?> {
        try COM.NullResult.unwrap(_interop.sendMessageAndGetReplyAsync(message))
    }

    /// Closes the USSD session with the network.
    public func close() throws {
        try _interop.close()
    }

    // MARK: Windows.Networking.NetworkOperators.IUssdSessionStatics members

    /// Creates a USSD session for the mobile device associated with the supplied network account ID.
    /// - Parameter networkAccountId: The network account ID to use to select the corresponding mobile broadband device to use for the USSD session.
    /// - Returns: The USSD session for the mobile device associated with the supplied network account ID.
    public static func createFromNetworkAccountId(_ networkAccountId: Swift.String) throws -> WindowsNetworkingNetworkOperators_UssdSession {
        try COM.NullResult.unwrap(_iussdSessionStatics.createFromNetworkAccountId(networkAccountId))
    }

    /// Creates a USSD session for the mobile device associated with the supplied network interface ID.
    /// - Parameter networkInterfaceId: The network interface ID to use to select the corresponding mobile broadband device to use for the USSD session.
    /// - Returns: The USSD session for the mobile device associated with the supplied network interface ID.
    public static func createFromNetworkInterfaceId(_ networkInterfaceId: Swift.String) throws -> WindowsNetworkingNetworkOperators_UssdSession {
        try COM.NullResult.unwrap(_iussdSessionStatics.createFromNetworkInterfaceId(networkInterfaceId))
    }

    // MARK: Implementation details

    private static var _iussdSessionStatics_storage: COM.COMInterop<CWinRT.SWRT_WindowsNetworkingNetworkOperators_IUssdSessionStatics>? = nil

    internal static var _iussdSessionStatics: COM.COMInterop<CWinRT.SWRT_WindowsNetworkingNetworkOperators_IUssdSessionStatics> {
        get throws {
            try _iussdSessionStatics_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.Networking.NetworkOperators.UssdSession", id: CWinRT.SWRT_WindowsNetworkingNetworkOperators_IUssdSessionStatics.iid)
            }
        }
    }
}