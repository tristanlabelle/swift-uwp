// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Represents an asynchronous action. This is the return type for many Windows Runtime asynchronous methods that don't have a result object, and don't report ongoing progress.
public protocol WindowsFoundation_IAsyncActionProtocol: WindowsFoundation_IAsyncInfoProtocol {
    /// Gets or sets the method that handles the action completed notification.
    /// - Returns: The method that handles the notification.
    var completed: WindowsFoundation_AsyncActionCompletedHandler { get throws }
    func completed(_ handler: WindowsFoundation_AsyncActionCompletedHandler?) throws

    /// Returns the results of the action.
    func getResults() throws
}

/// Represents an asynchronous action. This is the return type for many Windows Runtime asynchronous methods that don't have a result object, and don't report ongoing progress.
public typealias WindowsFoundation_IAsyncAction = any WindowsFoundation_IAsyncActionProtocol

extension WindowsFoundation_IAsyncActionProtocol {
    public func get() async throws {
        if try status == .started {
            guard try COM.NullResult.catch(completed) == nil else { throw COM.HResult.Error.illegalMethodCall }
            let awaiter = WindowsRuntime.AsyncAwaiter()
            try completed({ _, _ in _Concurrency.Task { await awaiter.signal() } })
            await awaiter.wait()
        }
        return try getResults()
    }
}