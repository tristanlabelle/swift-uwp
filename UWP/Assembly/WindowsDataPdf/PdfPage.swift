// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Represents a single page in a Portable Document Format (PDF) document.
public final class WindowsDataPdf_PdfPage: WindowsRuntime.WinRTImport<WindowsDataPdf_PdfPageProjection>, WindowsFoundation_IClosableProtocol {
    // MARK: Windows.Data.Pdf.IPdfPage members

    /// Gets the group of dimension properties for a single page in a Portable Document Format (PDF) document.
    /// - Returns: The group of page dimension properties.
    public var dimensions: WindowsDataPdf_PdfPageDimensions {
        get throws {
            try COM.NullResult.unwrap(_interop.get_Dimensions())
        }
    }

    /// Gets the relative position of the Portable Document Format (PDF) page within its parent Portable Document Format (PDF) document.
    /// - Returns: The position of the Portable Document Format (PDF) page relative to its parent Portable Document Format (PDF) document.
    public var index: Swift.UInt32 {
        get throws {
            try _interop.get_Index()
        }
    }

    /// Gets the Portable Document Format (PDF) page's preferred magnification factor.
    /// - Returns: The magnification scaling factor to display or print the Portable Document Format (PDF) page.
    public var preferredZoom: Swift.Float {
        get throws {
            try _interop.get_PreferredZoom()
        }
    }

    /// Gets the number of degrees that the Portable Document Format (PDF) page will be rotated when it's displayed or printed.
    /// - Returns: The number of degrees to rotate the Portable Document Format (PDF) page, expressed as one of the enumeration values.
    public var rotation: WindowsDataPdf_PdfPageRotation {
        get throws {
            try _interop.get_Rotation()
        }
    }

    /// Gets the Portable Document Format (PDF) page's size based on its related CropBox, MediaBox, and Rotation property values.
    /// - Returns: The Portable Document Format (PDF) page's computed size.
    public var size: WindowsFoundation_Size {
        get throws {
            try _interop.get_Size()
        }
    }

    /// Outputs a stream of data, which represents a Portable Document Format (PDF) page's contents, as an asynchronous action. This asynchronous action can be used to create an image of the Portable Document Format (PDF) page.
    /// - Parameter outputStream: The stream of data, which represents a Portable Document Format (PDF) page's content.
    /// - Returns: The asynchronous action.
    public func renderToStreamAsync(_ outputStream: WindowsStorageStreams_IRandomAccessStream?) throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.renderToStreamAsync(outputStream))
    }

    /// Takes a set of display settings, applies them to the output of a Portable Document Format (PDF) page's contents, and creates a stream with the customized, rendered output as an asynchronous action. This asynchronous action can be used to create a customized display image of the Portable Document Format (PDF) page.
    /// - Parameter outputStream: The stream of data, which represents a Portable Document Format (PDF) page's contents.
    /// - Parameter options: The requested set of display settings to apply to the display image that is output based on the Portable Document Format (PDF) page.
    /// - Returns: The asynchronous action.
    public func renderToStreamAsync(_ outputStream: WindowsStorageStreams_IRandomAccessStream?, _ options: WindowsDataPdf_PdfPageRenderOptions?) throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.renderWithOptionsToStreamAsync(outputStream, options))
    }

    /// Begins building the Portable Document Format (PDF) page. After this method finishes, the Portable Document Format (PDF) page is completely built.
    /// - Returns: Represents the fully-built Portable Document Format (PDF) page.
    public func preparePageAsync() throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.preparePageAsync())
    }

    // MARK: Windows.Foundation.IClosable members

    /// Releases all resources associated with the Portable Document Format (PDF) page.
    public func close() throws {
        try _iclosable.close()
    }

    // MARK: Implementation details

    private var _iclosable_storage: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable>? = nil

    internal var _iclosable: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable> {
        get throws {
            try _iclosable_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsFoundation_IClosable.iid).cast(to: CWinRT.SWRT_WindowsFoundation_IClosable.self)
            }
        }
    }

    deinit {
        _iclosable_storage?.release()
    }
}