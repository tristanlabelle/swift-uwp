// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// The entry point to all services provided by the Windows core text APIs and the text input server. This object is associated with an application's UI thread (the thread that CoreWindow runs on).
public final class WindowsUITextCore_CoreTextServicesManager: WindowsRuntime.WinRTImport<WindowsUITextCore_CoreTextServicesManagerProjection> {
    // MARK: Windows.UI.Text.Core.ICoreTextServicesManager members

    /// Gets a Language object representing the current input language.
    /// - Returns: An object representing the current input language.
    public var inputLanguage: WindowsGlobalization_Language {
        get throws {
            try COM.NullResult.unwrap(_interop.get_InputLanguage())
        }
    }

    /// Occurs when the current input language has changed.
    public func inputLanguageChanged(adding handler: WindowsFoundation_TypedEventHandler<WindowsUITextCore_CoreTextServicesManager?, WindowsRuntime.IInspectable?>?) throws -> WindowsRuntime.EventRegistration {
        let _token = try _interop.add_InputLanguageChanged(handler)
        return WindowsRuntime.EventRegistration(token: _token, remover: inputLanguageChanged)
    }

    public func inputLanguageChanged(removing cookie: WindowsRuntime.EventRegistrationToken) throws {
        try _interop.remove_InputLanguageChanged(cookie)
    }

    /// Creates a context object used by a text input control to communicate with the text input server. Each text input control must create its own context object.
    /// - Returns: A CoreTextEditContext instance, which is the primary object used for communicating with the text input server.
    public func createEditContext() throws -> WindowsUITextCore_CoreTextEditContext {
        try COM.NullResult.unwrap(_interop.createEditContext())
    }

    // MARK: Windows.UI.Text.Core.ICoreTextServicesManagerStatics members

    /// Gets the CoreTextServicesManager object for the currently active view.
    /// - Returns: A CoreTextServicesManager instance, which can be used to create further objects to support the app's text input scenarios.
    public static func getForCurrentView() throws -> WindowsUITextCore_CoreTextServicesManager {
        try COM.NullResult.unwrap(_icoreTextServicesManagerStatics.getForCurrentView())
    }

    // MARK: Implementation details

    private static var _icoreTextServicesManagerStatics_storage: COM.COMInterop<CWinRT.SWRT_WindowsUITextCore_ICoreTextServicesManagerStatics>? = nil

    internal static var _icoreTextServicesManagerStatics: COM.COMInterop<CWinRT.SWRT_WindowsUITextCore_ICoreTextServicesManagerStatics> {
        get throws {
            try _icoreTextServicesManagerStatics_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.UI.Text.Core.CoreTextServicesManager", id: CWinRT.SWRT_WindowsUITextCore_ICoreTextServicesManagerStatics.iid)
            }
        }
    }
}