// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Represents a delayed data loader for a contact card.
public final class WindowsApplicationModelContacts_ContactCardDelayedDataLoader: WindowsRuntime.WinRTImport<WindowsApplicationModelContacts_ContactCardDelayedDataLoaderProjection>, WindowsFoundation_IClosableProtocol {
    // MARK: Windows.ApplicationModel.Contacts.IContactCardDelayedDataLoader members

    /// Updates the contact card with the Contact object and completes the contact card UI.
    /// - Parameter contact: The contact to update the contact card with.
    public func setData(_ contact: WindowsApplicationModelContacts_Contact?) throws {
        try _interop.setData(contact)
    }

    // MARK: Windows.Foundation.IClosable members

    /// Closes the delayed data loader. This informs the contact card to complete the UI (for example, remove any progress indications, like the progress bar) because no more updates to the contact card UI will be requested. The user then can determine that the contact data shown in the UI is complete.
    public func close() throws {
        try _iclosable.close()
    }

    // MARK: Implementation details

    private var _iclosable_storage: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable>? = nil

    internal var _iclosable: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable> {
        get throws {
            try _iclosable_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsFoundation_IClosable.iid).cast(to: CWinRT.SWRT_WindowsFoundation_IClosable.self)
            }
        }
    }

    deinit {
        _iclosable_storage?.release()
    }
}