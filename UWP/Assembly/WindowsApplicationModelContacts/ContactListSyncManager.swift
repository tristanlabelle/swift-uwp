// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Provides functionality for syncing contact information with the server.
public final class WindowsApplicationModelContacts_ContactListSyncManager: WindowsRuntime.WinRTImport<WindowsApplicationModelContacts_ContactListSyncManagerProjection> {
    // MARK: Windows.ApplicationModel.Contacts.IContactListSyncManager members

    /// Gets or sets the last time a sync was attempted with the server.
    /// - Returns: The last time a sync was attempted with the server.
    public var lastAttemptedSyncTime: WindowsFoundation_DateTime {
        get throws {
            try _interop.get_LastAttemptedSyncTime()
        }
    }

    /// Gets or sets the last time the ContactList was successfully synced with the server.
    /// - Returns: The last time the ContactList was successfully synced with the server.
    public var lastSuccessfulSyncTime: WindowsFoundation_DateTime {
        get throws {
            try _interop.get_LastSuccessfulSyncTime()
        }
    }

    /// Gets or sets the ContactListSyncStatus.
    /// - Returns: The ContactListSyncStatus.
    public var status: WindowsApplicationModelContacts_ContactListSyncStatus {
        get throws {
            try _interop.get_Status()
        }
    }

    /// Occurs when the sync status with the server has changed.
    public func syncStatusChanged(adding handler: WindowsFoundation_TypedEventHandler<WindowsApplicationModelContacts_ContactListSyncManager?, WindowsRuntime.IInspectable?>?) throws -> WindowsRuntime.EventRegistration {
        let _token = try _interop.add_SyncStatusChanged(handler)
        return WindowsRuntime.EventRegistration(token: _token, remover: syncStatusChanged)
    }

    public func syncStatusChanged(removing token: WindowsRuntime.EventRegistrationToken) throws {
        try _interop.remove_SyncStatusChanged(token)
    }

    /// Asynchronously attempts to sync with the contacts server.
    /// - Returns: A Boolean value indicating if the sync was successful.
    public func syncAsync() throws -> WindowsFoundation_IAsyncOperation<Swift.Bool> {
        try COM.NullResult.unwrap(_interop.syncAsync())
    }

    // MARK: Windows.ApplicationModel.Contacts.IContactListSyncManager2 members

    /// Gets or sets the last time a sync was attempted with the server.
    /// - Returns: The last time a sync was attempted with the server.
    public func lastAttemptedSyncTime(_ value: WindowsFoundation_DateTime) throws {
        try _icontactListSyncManager2.put_LastAttemptedSyncTime(value)
    }

    /// Gets or sets the last time the ContactList was successfully synced with the server.
    /// - Returns: The last time the ContactList was successfully synced with the server.
    public func lastSuccessfulSyncTime(_ value: WindowsFoundation_DateTime) throws {
        try _icontactListSyncManager2.put_LastSuccessfulSyncTime(value)
    }

    /// Gets or sets the ContactListSyncStatus.
    /// - Returns: The ContactListSyncStatus.
    public func status(_ value: WindowsApplicationModelContacts_ContactListSyncStatus) throws {
        try _icontactListSyncManager2.put_Status(value)
    }

    // MARK: Implementation details

    private var _icontactListSyncManager2_storage: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelContacts_IContactListSyncManager2>? = nil

    internal var _icontactListSyncManager2: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelContacts_IContactListSyncManager2> {
        get throws {
            try _icontactListSyncManager2_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsApplicationModelContacts_IContactListSyncManager2.iid).cast(to: CWinRT.SWRT_WindowsApplicationModelContacts_IContactListSyncManager2.self)
            }
        }
    }

    deinit {
        _icontactListSyncManager2_storage?.release()
    }
}