// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Provides access to the users Cortana authorization settings.
public final class WindowsServicesCortana_CortanaPermissionsManager: WindowsRuntime.WinRTImport<WindowsServicesCortana_CortanaPermissionsManagerProjection> {
    // MARK: Windows.Services.Cortana.ICortanaPermissionsManager members

    /// Retrieves whether Cortana is supported.
    /// - Returns: **true** if Cortana is supported. Otherwise, **false**.
    public func isSupported() throws -> Swift.Bool {
        try _interop.isSupported()
    }

    public func arePermissionsGrantedAsync(_ permissions: WindowsFoundationCollections_IIterable<WindowsServicesCortana_CortanaPermission>?) throws -> WindowsFoundation_IAsyncOperation<Swift.Bool> {
        try COM.NullResult.unwrap(_interop.arePermissionsGrantedAsync(permissions))
    }

    public func grantPermissionsAsync(_ permissions: WindowsFoundationCollections_IIterable<WindowsServicesCortana_CortanaPermission>?) throws -> WindowsFoundation_IAsyncOperation<WindowsServicesCortana_CortanaPermissionsChangeResult> {
        try COM.NullResult.unwrap(_interop.grantPermissionsAsync(permissions))
    }

    public func revokePermissionsAsync(_ permissions: WindowsFoundationCollections_IIterable<WindowsServicesCortana_CortanaPermission>?) throws -> WindowsFoundation_IAsyncOperation<WindowsServicesCortana_CortanaPermissionsChangeResult> {
        try COM.NullResult.unwrap(_interop.revokePermissionsAsync(permissions))
    }

    // MARK: Windows.Services.Cortana.ICortanaPermissionsManagerStatics members

    /// Retrieves the Cortana permissions for the current user.
    public static func getDefault() throws -> WindowsServicesCortana_CortanaPermissionsManager {
        try COM.NullResult.unwrap(_icortanaPermissionsManagerStatics.getDefault())
    }

    // MARK: Implementation details

    private static var _icortanaPermissionsManagerStatics_storage: COM.COMInterop<CWinRT.SWRT_WindowsServicesCortana_ICortanaPermissionsManagerStatics>? = nil

    internal static var _icortanaPermissionsManagerStatics: COM.COMInterop<CWinRT.SWRT_WindowsServicesCortana_ICortanaPermissionsManagerStatics> {
        get throws {
            try _icortanaPermissionsManagerStatics_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.Services.Cortana.CortanaPermissionsManager", id: CWinRT.SWRT_WindowsServicesCortana_ICortanaPermissionsManagerStatics.iid)
            }
        }
    }
}