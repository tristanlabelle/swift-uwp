// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Manages the collections of audio device modules for a audio device pin instance or for a particular audio endpoint.
public final class WindowsMediaDevices_AudioDeviceModulesManager: WindowsRuntime.WinRTImport<WindowsMediaDevices_AudioDeviceModulesManagerProjection> {
    // MARK: Windows.Media.Devices.IAudioDeviceModulesManagerFactory members

    public convenience init(_ deviceId: Swift.String) throws {
        self.init(_transferringRef: try COM.NullResult.unwrap(Self._iaudioDeviceModulesManagerFactory.create(deviceId)))
    }

    // MARK: Windows.Media.Devices.IAudioDeviceModulesManager members

    /// Occurs when a change occurs in one of the audio device modules associated with the audio device for which the **AudioDeviceModulesManager** was initialized.
    public func moduleNotificationReceived(adding handler: WindowsFoundation_TypedEventHandler<WindowsMediaDevices_AudioDeviceModulesManager?, WindowsMediaDevices_AudioDeviceModuleNotificationEventArgs?>?) throws -> WindowsRuntime.EventRegistration {
        let _token = try _interop.add_ModuleNotificationReceived(handler)
        return WindowsRuntime.EventRegistration(token: _token, remover: moduleNotificationReceived)
    }

    public func moduleNotificationReceived(removing token: WindowsRuntime.EventRegistrationToken) throws {
        try _interop.remove_ModuleNotificationReceived(token)
    }

    /// Retrieves a list of all audio device modules with the specified ID. Each audio device module in the list will have the same ID, but each will have a different value for the AudioDeviceModule.InstanceId property.
    /// - Parameter moduleId: The identifier of the audio device modules to be retrieved.
    /// - Returns: A list of all audio device modules with the specified ID.
    public func findAllById(_ moduleId: Swift.String) throws -> WindowsFoundationCollections_IVectorView<WindowsMediaDevices_AudioDeviceModule?> {
        try COM.NullResult.unwrap(_interop.findAllById(moduleId))
    }

    /// Retreives a list of all audio device modules associated with the audio device for which the **AudioDeviceModulesManager** was initialized.
    /// - Returns: A list of all audio device modules.
    public func findAll() throws -> WindowsFoundationCollections_IVectorView<WindowsMediaDevices_AudioDeviceModule?> {
        try COM.NullResult.unwrap(_interop.findAll())
    }

    // MARK: Implementation details

    private static var _iaudioDeviceModulesManagerFactory_storage: COM.COMInterop<CWinRT.SWRT_WindowsMediaDevices_IAudioDeviceModulesManagerFactory>? = nil

    internal static var _iaudioDeviceModulesManagerFactory: COM.COMInterop<CWinRT.SWRT_WindowsMediaDevices_IAudioDeviceModulesManagerFactory> {
        get throws {
            try _iaudioDeviceModulesManagerFactory_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.Media.Devices.AudioDeviceModulesManager", id: CWinRT.SWRT_WindowsMediaDevices_IAudioDeviceModulesManagerFactory.iid)
            }
        }
    }
}