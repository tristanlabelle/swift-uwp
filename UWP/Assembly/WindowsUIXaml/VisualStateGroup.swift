// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Contains mutually exclusive VisualState objects and VisualTransition objects that are used to go from one state to another.
public final class WindowsUIXaml_VisualStateGroup: WindowsRuntime.WinRTImport<WindowsUIXaml_VisualStateGroupProjection> {
    // MARK: IActivationFactory members

    public convenience init() throws {
        self.init(_transferringRef: try Self._iactivationFactory.activateInstance(projection: WindowsUIXaml_VisualStateGroupProjection.self))
    }

    // MARK: Windows.UI.Xaml.IVisualStateGroup members

    /// Gets the most recently set VisualState from a successful call to the GoToState method.
    /// - Returns: The most recently set VisualState from a successful call to the GoToState method, or **null**.
    public var currentState: WindowsUIXaml_VisualState {
        get throws {
            try COM.NullResult.unwrap(_interop.get_CurrentState())
        }
    }

    /// Gets the name of the VisualStateGroup.
    /// - Returns: The name of the VisualStateGroup.
    public var name: Swift.String {
        get throws {
            try _interop.get_Name()
        }
    }

    /// Gets the collection of mutually exclusive VisualState objects.
    /// - Returns: The collection of mutually exclusive VisualState objects.
    public var states: WindowsFoundationCollections_IVector<WindowsUIXaml_VisualState?> {
        get throws {
            try COM.NullResult.unwrap(_interop.get_States())
        }
    }

    /// Gets the collection of VisualTransition objects.
    /// - Returns: The collection of VisualTransition objects.
    public var transitions: WindowsFoundationCollections_IVector<WindowsUIXaml_VisualTransition?> {
        get throws {
            try COM.NullResult.unwrap(_interop.get_Transitions())
        }
    }

    /// Occurs after a control changes into a different state.
    public func currentStateChanged(adding handler: WindowsUIXaml_VisualStateChangedEventHandler?) throws -> WindowsRuntime.EventRegistration {
        let _token = try _interop.add_CurrentStateChanged(handler)
        return WindowsRuntime.EventRegistration(token: _token, remover: currentStateChanged)
    }

    public func currentStateChanged(removing token: WindowsRuntime.EventRegistrationToken) throws {
        try _interop.remove_CurrentStateChanged(token)
    }

    /// Occurs when a control begins changing into a different state.
    public func currentStateChanging(adding handler: WindowsUIXaml_VisualStateChangedEventHandler?) throws -> WindowsRuntime.EventRegistration {
        let _token = try _interop.add_CurrentStateChanging(handler)
        return WindowsRuntime.EventRegistration(token: _token, remover: currentStateChanging)
    }

    public func currentStateChanging(removing token: WindowsRuntime.EventRegistrationToken) throws {
        try _interop.remove_CurrentStateChanging(token)
    }

    // MARK: Implementation details

    private static var _iactivationFactory_storage: COM.COMInterop<CWinRT.SWRT_IActivationFactory>? = nil

    internal static var _iactivationFactory: COM.COMInterop<CWinRT.SWRT_IActivationFactory> {
        get throws {
            try _iactivationFactory_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.UI.Xaml.VisualStateGroup", id: CWinRT.SWRT_IActivationFactory.iid)
            }
        }
    }
}