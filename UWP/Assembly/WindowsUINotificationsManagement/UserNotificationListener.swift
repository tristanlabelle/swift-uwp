// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Reads and manages a user's notifications.
public final class WindowsUINotificationsManagement_UserNotificationListener: WindowsRuntime.WinRTImport<WindowsUINotificationsManagement_UserNotificationListenerProjection> {
    // MARK: Windows.UI.Notifications.Management.IUserNotificationListener members

    /// Occurs when a notification is added or removed.
    public func notificationChanged(adding handler: WindowsFoundation_TypedEventHandler<WindowsUINotificationsManagement_UserNotificationListener?, WindowsUINotifications_UserNotificationChangedEventArgs?>?) throws -> WindowsRuntime.EventRegistration {
        let _token = try _interop.add_NotificationChanged(handler)
        return WindowsRuntime.EventRegistration(token: _token, remover: notificationChanged)
    }

    public func notificationChanged(removing token: WindowsRuntime.EventRegistrationToken) throws {
        try _interop.remove_NotificationChanged(token)
    }

    /// Requests the user's permission to manage notifications.
    /// - Returns: A value that specifies whether the user chose to provide access to notification.
    public func requestAccessAsync() throws -> WindowsFoundation_IAsyncOperation<WindowsUINotificationsManagement_UserNotificationListenerAccessStatus> {
        try COM.NullResult.unwrap(_interop.requestAccessAsync())
    }

    /// Gets a value that indicates whether the UserNotificationListener has access to the user's notifications.
    /// - Returns: A value that indicates whether the UserNotificationListener has access to the user's notifications.
    public func getAccessStatus() throws -> WindowsUINotificationsManagement_UserNotificationListenerAccessStatus {
        try _interop.getAccessStatus()
    }

    /// Asynchronously retrieves notifications that match the specified notification kind.
    /// - Parameter kinds: The type of notification to retrieve.
    /// - Returns: A collection of notifications of the specified type.
    public func getNotificationsAsync(_ kinds: WindowsUINotifications_NotificationKinds) throws -> WindowsFoundation_IAsyncOperation<WindowsFoundationCollections_IVectorView<WindowsUINotifications_UserNotification?>?> {
        try COM.NullResult.unwrap(_interop.getNotificationsAsync(kinds))
    }

    /// Retrieves the specified notification.
    /// - Parameter notificationId: The ID of the notification to retrieve.
    /// - Returns: The notification if it exists; otherwise, **null**.
    public func getNotification(_ notificationId: Swift.UInt32) throws -> WindowsUINotifications_UserNotification {
        try COM.NullResult.unwrap(_interop.getNotification(notificationId))
    }

    /// Clears the notification.
    public func clearNotifications() throws {
        try _interop.clearNotifications()
    }

    /// Removes the specified notification.
    /// - Parameter notificationId: The ID of the notification to remove.
    public func removeNotification(_ notificationId: Swift.UInt32) throws {
        try _interop.removeNotification(notificationId)
    }

    // MARK: Windows.UI.Notifications.Management.IUserNotificationListenerStatics members

    /// Gets a UserNotificationListener for the current user.
    /// - Returns: A UserNotificationListener for the current user.
    public static var current: WindowsUINotificationsManagement_UserNotificationListener {
        get throws {
            try COM.NullResult.unwrap(_iuserNotificationListenerStatics.get_Current())
        }
    }

    // MARK: Implementation details

    private static var _iuserNotificationListenerStatics_storage: COM.COMInterop<CWinRT.SWRT_WindowsUINotificationsManagement_IUserNotificationListenerStatics>? = nil

    internal static var _iuserNotificationListenerStatics: COM.COMInterop<CWinRT.SWRT_WindowsUINotificationsManagement_IUserNotificationListenerStatics> {
        get throws {
            try _iuserNotificationListenerStatics_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.UI.Notifications.Management.UserNotificationListener", id: CWinRT.SWRT_WindowsUINotificationsManagement_IUserNotificationListenerStatics.iid)
            }
        }
    }
}