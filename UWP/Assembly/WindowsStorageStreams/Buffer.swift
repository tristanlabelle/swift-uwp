// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Provides a default implementation of the IBuffer interface and its related interfaces.
public final class WindowsStorageStreams_Buffer: WindowsRuntime.WinRTImport<WindowsStorageStreams_BufferProjection>, WindowsStorageStreams_IBufferProtocol {
    // MARK: Windows.Storage.Streams.IBufferFactory members

    public convenience init(_ capacity: Swift.UInt32) throws {
        self.init(_transferringRef: try COM.NullResult.unwrap(Self._ibufferFactory.create(capacity)))
    }

    // MARK: Windows.Storage.Streams.IBuffer members

    /// Gets the maximum number of bytes that the buffer can hold.
    /// - Returns: The maximum number of bytes that the buffer can hold.
    public var capacity: Swift.UInt32 {
        get throws {
            try _interop.get_Capacity()
        }
    }

    /// Gets the number of bytes currently in use in the buffer.
    /// - Returns: The number of bytes currently in use in the buffer, which is less than or equal to the capacity of the buffer.
    public var length: Swift.UInt32 {
        get throws {
            try _interop.get_Length()
        }
    }

    /// Gets the number of bytes currently in use in the buffer.
    /// - Returns: The number of bytes currently in use in the buffer, which is less than or equal to the capacity of the buffer.
    public func length(_ value: Swift.UInt32) throws {
        try _interop.put_Length(value)
    }

    // MARK: Windows.Storage.Streams.IBufferStatics members

    /// Creates a new buffer containing a copy of a specified buffer.
    /// - Parameter input: The buffer to be copied.
    /// - Returns: The newly created copy.
    public static func createCopyFromMemoryBuffer(_ input: WindowsFoundation_IMemoryBuffer?) throws -> WindowsStorageStreams_Buffer {
        try COM.NullResult.unwrap(_ibufferStatics.createCopyFromMemoryBuffer(input))
    }

    /// Creates a MemoryBuffer from an existing IBuffer.
    /// - Parameter input: The input IBuffer.
    /// - Returns: The newly created MemoryBuffer.
    public static func createMemoryBufferOverIBuffer(_ input: WindowsStorageStreams_IBuffer?) throws -> WindowsFoundation_MemoryBuffer {
        try COM.NullResult.unwrap(_ibufferStatics.createMemoryBufferOverIBuffer(input))
    }

    // MARK: Implementation details

    private static var _ibufferFactory_storage: COM.COMInterop<CWinRT.SWRT_WindowsStorageStreams_IBufferFactory>? = nil

    internal static var _ibufferFactory: COM.COMInterop<CWinRT.SWRT_WindowsStorageStreams_IBufferFactory> {
        get throws {
            try _ibufferFactory_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.Storage.Streams.Buffer", id: CWinRT.SWRT_WindowsStorageStreams_IBufferFactory.iid)
            }
        }
    }

    private static var _ibufferStatics_storage: COM.COMInterop<CWinRT.SWRT_WindowsStorageStreams_IBufferStatics>? = nil

    internal static var _ibufferStatics: COM.COMInterop<CWinRT.SWRT_WindowsStorageStreams_IBufferStatics> {
        get throws {
            try _ibufferStatics_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.Storage.Streams.Buffer", id: CWinRT.SWRT_WindowsStorageStreams_IBufferStatics.iid)
            }
        }
    }
}