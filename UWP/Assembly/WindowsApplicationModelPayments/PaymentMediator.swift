// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// This class is used to submit payment requests.
public final class WindowsApplicationModelPayments_PaymentMediator: WindowsRuntime.WinRTImport<WindowsApplicationModelPayments_PaymentMediatorProjection> {
    // MARK: IActivationFactory members

    public convenience init() throws {
        self.init(_transferringRef: try Self._iactivationFactory.activateInstance(projection: WindowsApplicationModelPayments_PaymentMediatorProjection.self))
    }

    // MARK: Windows.ApplicationModel.Payments.IPaymentMediator members

    /// Gets the list of payment methods currently supported.
    /// - Returns: When the asynchronous operation completes, it returns a collection of the supported payment methods.
    public func getSupportedMethodIdsAsync() throws -> WindowsFoundation_IAsyncOperation<WindowsFoundationCollections_IVectorView<Swift.String>?> {
        try COM.NullResult.unwrap(_interop.getSupportedMethodIdsAsync())
    }

    /// Submits a payment request.
    /// - Parameter paymentRequest: The payment request.
    /// - Returns: When the asynchronous operation completes, it returns a submission result.
    public func submitPaymentRequestAsync(_ paymentRequest: WindowsApplicationModelPayments_PaymentRequest?) throws -> WindowsFoundation_IAsyncOperation<WindowsApplicationModelPayments_PaymentRequestSubmitResult?> {
        try COM.NullResult.unwrap(_interop.submitPaymentRequestAsync(paymentRequest))
    }

    /// Submits a payment request.
    /// - Parameter paymentRequest: The payment request.
    /// - Parameter changeHandler: A handler for when the payment request changes.
    /// - Returns: When the asynchronous operation completes it returns submission results.
    public func submitPaymentRequestAsync(_ paymentRequest: WindowsApplicationModelPayments_PaymentRequest?, _ changeHandler: WindowsApplicationModelPayments_PaymentRequestChangedHandler?) throws -> WindowsFoundation_IAsyncOperation<WindowsApplicationModelPayments_PaymentRequestSubmitResult?> {
        try COM.NullResult.unwrap(_interop.submitPaymentRequestWithChangeHandlerAsync(paymentRequest, changeHandler))
    }

    // MARK: Windows.ApplicationModel.Payments.IPaymentMediator2 members

    /// This method checks if a payment can be made on the paymentRequest.
    /// - Parameter paymentRequest: The payment request to check.
    /// - Returns: Returns an asynchronous operation that completes with a bool indicating whether a payment can be made.
    public func canMakePaymentAsync(_ paymentRequest: WindowsApplicationModelPayments_PaymentRequest?) throws -> WindowsFoundation_IAsyncOperation<WindowsApplicationModelPayments_PaymentCanMakePaymentResult?> {
        try COM.NullResult.unwrap(_ipaymentMediator2.canMakePaymentAsync(paymentRequest))
    }

    // MARK: Implementation details

    private var _ipaymentMediator2_storage: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelPayments_IPaymentMediator2>? = nil

    internal var _ipaymentMediator2: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelPayments_IPaymentMediator2> {
        get throws {
            try _ipaymentMediator2_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsApplicationModelPayments_IPaymentMediator2.iid).cast(to: CWinRT.SWRT_WindowsApplicationModelPayments_IPaymentMediator2.self)
            }
        }
    }

    deinit {
        _ipaymentMediator2_storage?.release()
    }

    private static var _iactivationFactory_storage: COM.COMInterop<CWinRT.SWRT_IActivationFactory>? = nil

    internal static var _iactivationFactory: COM.COMInterop<CWinRT.SWRT_IActivationFactory> {
        get throws {
            try _iactivationFactory_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.ApplicationModel.Payments.PaymentMediator", id: CWinRT.SWRT_IActivationFactory.iid)
            }
        }
    }
}