// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Manages connections to associated Wi-Fi Direct devices.
public final class WindowsDevicesWiFiDirect_WiFiDirectDevice: WindowsRuntime.WinRTImport<WindowsDevicesWiFiDirect_WiFiDirectDeviceProjection>, WindowsFoundation_IClosableProtocol {
    // MARK: Windows.Devices.WiFiDirect.IWiFiDirectDevice members

    /// Gets the connection status for the WiFi-Direct device.
    /// - Returns: The connection status for the WiFi-Direct device.
    public var connectionStatus: WindowsDevicesWiFiDirect_WiFiDirectConnectionStatus {
        get throws {
            try _interop.get_ConnectionStatus()
        }
    }

    /// Gets the DeviceInformation Id for the Wi-Fi Direct device.
    /// - Returns: The DeviceInformation Id for the Wi-Fi Direct device.
    public var deviceId: Swift.String {
        get throws {
            try _interop.get_DeviceId()
        }
    }

    /// Occurs when a Wi-Fi Direct device connection is connected or disconnected.
    public func connectionStatusChanged(adding handler: WindowsFoundation_TypedEventHandler<WindowsDevicesWiFiDirect_WiFiDirectDevice?, WindowsRuntime.IInspectable?>?) throws -> WindowsRuntime.EventRegistration {
        let _token = try _interop.add_ConnectionStatusChanged(handler)
        return WindowsRuntime.EventRegistration(token: _token, remover: connectionStatusChanged)
    }

    public func connectionStatusChanged(removing token: WindowsRuntime.EventRegistrationToken) throws {
        try _interop.remove_ConnectionStatusChanged(token)
    }

    /// Gets a collection of network addresses for the Wi-Fi Direct device as endpoint pairs.
    /// - Returns: A collection of network addresses for the Wi-Fi Direct device as endpoint pairs.
    public func getConnectionEndpointPairs() throws -> WindowsFoundationCollections_IVectorView<WindowsNetworking_EndpointPair?> {
        try COM.NullResult.unwrap(_interop.getConnectionEndpointPairs())
    }

    // MARK: Windows.Foundation.IClosable members

    /// Close the active Wi-Fi Direct device connection.
    public func close() throws {
        try _iclosable.close()
    }

    // MARK: Windows.Devices.WiFiDirect.IWiFiDirectDeviceStatics2 members

    /// Returns the class selection string that you can use to enumerate Wi-Fi Direct devices for a specific Wi-Fi Direct device selector type.
    /// - Parameter type: A specific Wi-Fi Direct device selector type.
    /// - Returns: The class selection string that you can use to enumerate Wi-Fi Direct devices.
    public static func getDeviceSelector(_ type: WindowsDevicesWiFiDirect_WiFiDirectDeviceSelectorType) throws -> Swift.String {
        try _iwiFiDirectDeviceStatics2.getDeviceSelector(type)
    }

    /// Creates an instance of the WiFiDirectDevice class for the specified device interface id with specific connection parameters.
    /// - Parameter deviceId: The DeviceInformation Id of a Wi-Fi Direct device.
    /// - Parameter connectionParameters: Connection parameters for a Wi-Fi Direct connect/pairing operation.
    /// - Returns: An asynchronous operation to retrieve the WiFiDirectDevice that was created.
    public static func fromIdAsync(_ deviceId: Swift.String, _ connectionParameters: WindowsDevicesWiFiDirect_WiFiDirectConnectionParameters?) throws -> WindowsFoundation_IAsyncOperation<WindowsDevicesWiFiDirect_WiFiDirectDevice?> {
        try COM.NullResult.unwrap(_iwiFiDirectDeviceStatics2.fromIdAsync(deviceId, connectionParameters))
    }

    // MARK: Windows.Devices.WiFiDirect.IWiFiDirectDeviceStatics members

    /// Returns the class selection string that you can use to enumerate Wi-Fi Direct devices.
    /// - Returns: The class selection string that you can use to enumerate Wi-Fi Direct devices.
    public static func getDeviceSelector() throws -> Swift.String {
        try _iwiFiDirectDeviceStatics.getDeviceSelector()
    }

    /// Creates an instance of the WiFiDirectDevice class for the specified device interface id.
    /// - Parameter deviceId: The DeviceInformation Id of a Wi-Fi Direct device.
    /// - Returns: An asynchronous operation to retrieve the WiFiDirectDevice that was created.
    public static func fromIdAsync(_ deviceId: Swift.String) throws -> WindowsFoundation_IAsyncOperation<WindowsDevicesWiFiDirect_WiFiDirectDevice?> {
        try COM.NullResult.unwrap(_iwiFiDirectDeviceStatics.fromIdAsync(deviceId))
    }

    // MARK: Implementation details

    private var _iclosable_storage: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable>? = nil

    internal var _iclosable: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable> {
        get throws {
            try _iclosable_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsFoundation_IClosable.iid).cast(to: CWinRT.SWRT_WindowsFoundation_IClosable.self)
            }
        }
    }

    deinit {
        _iclosable_storage?.release()
    }

    private static var _iwiFiDirectDeviceStatics2_storage: COM.COMInterop<CWinRT.SWRT_WindowsDevicesWiFiDirect_IWiFiDirectDeviceStatics2>? = nil

    internal static var _iwiFiDirectDeviceStatics2: COM.COMInterop<CWinRT.SWRT_WindowsDevicesWiFiDirect_IWiFiDirectDeviceStatics2> {
        get throws {
            try _iwiFiDirectDeviceStatics2_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.Devices.WiFiDirect.WiFiDirectDevice", id: CWinRT.SWRT_WindowsDevicesWiFiDirect_IWiFiDirectDeviceStatics2.iid)
            }
        }
    }

    private static var _iwiFiDirectDeviceStatics_storage: COM.COMInterop<CWinRT.SWRT_WindowsDevicesWiFiDirect_IWiFiDirectDeviceStatics>? = nil

    internal static var _iwiFiDirectDeviceStatics: COM.COMInterop<CWinRT.SWRT_WindowsDevicesWiFiDirect_IWiFiDirectDeviceStatics> {
        get throws {
            try _iwiFiDirectDeviceStatics_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.Devices.WiFiDirect.WiFiDirectDevice", id: CWinRT.SWRT_WindowsDevicesWiFiDirect_IWiFiDirectDeviceStatics.iid)
            }
        }
    }
}