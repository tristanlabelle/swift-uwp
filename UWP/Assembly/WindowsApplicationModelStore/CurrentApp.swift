// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Defines methods and properties you can use to get license and listing info about the current app and perform in-app product purchases.
public enum WindowsApplicationModelStore_CurrentApp {
    // MARK: Windows.ApplicationModel.Store.ICurrentAppWithCampaignId members

    /// Retrieves the promotion campaign ID for the current app.
    /// - Returns: The advertising campaign ID for your app.
    public static func getAppPurchaseCampaignIdAsync() throws -> WindowsFoundation_IAsyncOperation<Swift.String> {
        try COM.NullResult.unwrap(_icurrentAppWithCampaignId.getAppPurchaseCampaignIdAsync())
    }

    // MARK: Windows.ApplicationModel.Store.ICurrentApp2Statics members

    /// Retrieves a Microsoft Store ID key that can be used to grant entitlements for free products on behalf of the current user.
    /// - Parameter serviceTicket: An Azure Active Directory access token that identifies the publisher of the current app. For more information about generating this token, see Manage product entitlements from a service.
    /// - Parameter publisherUserId: An anonymous ID that identifies the current user in the context of services that you manage as the publisher of the current app. If you maintain user IDs in the context of your services, you can use this parameter to associate your ID for the current user with the new Microsoft Store ID key (the user ID will be embedded in the key). Otherwise, if you don't need to associate a user ID with the Microsoft Store ID key, you can pass any string value.
    /// - Returns: The purchase ID key for the current user. This key is valid for 90 days.
    public static func getCustomerPurchaseIdAsync(_ serviceTicket: Swift.String, _ publisherUserId: Swift.String) throws -> WindowsFoundation_IAsyncOperation<Swift.String> {
        try COM.NullResult.unwrap(_icurrentApp2Statics.getCustomerPurchaseIdAsync(serviceTicket, publisherUserId))
    }

    /// Retrieves a Microsoft Store ID key that can be used to query for product entitlements or to consume product entitlements that are owned by the current user.
    /// - Parameter serviceTicket: An Azure Active Directory access token that identifies the publisher of the current app. For more information about generating this token, see Manage product entitlements from a service.
    /// - Parameter publisherUserId: An anonymous ID that identifies the current user in the context of services that you manage as the publisher of the current app. If you maintain user IDs in the context of your services, you can use this parameter to associate your ID for the current user with the new Microsoft Store ID key (the user ID will be embedded in the key). Otherwise, if you don't need to associate a user ID with the Microsoft Store ID key, you can pass any string value.
    /// - Returns: The collections ID key for the current user. This key is valid for 90 days.
    public static func getCustomerCollectionsIdAsync(_ serviceTicket: Swift.String, _ publisherUserId: Swift.String) throws -> WindowsFoundation_IAsyncOperation<Swift.String> {
        try COM.NullResult.unwrap(_icurrentApp2Statics.getCustomerCollectionsIdAsync(serviceTicket, publisherUserId))
    }

    // MARK: Windows.ApplicationModel.Store.ICurrentAppStaticsWithFiltering members

    public static func loadListingInformationByProductIdsAsync(_ productIds: WindowsFoundationCollections_IIterable<Swift.String>?) throws -> WindowsFoundation_IAsyncOperation<WindowsApplicationModelStore_ListingInformation?> {
        try COM.NullResult.unwrap(_icurrentAppStaticsWithFiltering.loadListingInformationByProductIdsAsync(productIds))
    }

    public static func loadListingInformationByKeywordsAsync(_ keywords: WindowsFoundationCollections_IIterable<Swift.String>?) throws -> WindowsFoundation_IAsyncOperation<WindowsApplicationModelStore_ListingInformation?> {
        try COM.NullResult.unwrap(_icurrentAppStaticsWithFiltering.loadListingInformationByKeywordsAsync(keywords))
    }

    /// Notifies the Microsoft Store that the application has fulfilled the in-app product. This product cannot be re-purchased until the app has confirmed fulfillment using this method.
    /// - Parameter productId: The ID of the product that has been delivered to the user.
    public static func reportProductFulfillment(_ productId: Swift.String) throws {
        try _icurrentAppStaticsWithFiltering.reportProductFulfillment(productId)
    }

    // MARK: Windows.ApplicationModel.Store.ICurrentApp members

    /// Gets the GUID generated by the Windows Store when your app has been certified for listing in the Windows Store.
    /// - Returns: The GUID that identifies the app in the Windows Store.
    public static var appId: Foundation.UUID {
        get throws {
            try _icurrentApp.get_AppId()
        }
    }

    /// Gets the license metadata for the current app.
    /// - Returns: The license metadata for the current app.
    public static var licenseInformation: WindowsApplicationModelStore_LicenseInformation {
        get throws {
            try COM.NullResult.unwrap(_icurrentApp.get_LicenseInformation())
        }
    }

    /// Gets the Uniform Resource Identifier (URI) of the app's listing page in the web catalog of the Windows Store.
    /// - Returns: The Uniform Resource Identifier (URI) of the app's listing page in the Windows Store.
    public static var linkUri: WindowsFoundation_Uri {
        get throws {
            try COM.NullResult.unwrap(_icurrentApp.get_LinkUri())
        }
    }

    /// Requests the purchase of a full app license.
    /// - Parameter includeReceipt: Determines if this method should return the receipts for this app.
    /// - Returns: If the *includeReceipt* parameter is set to true, this string contains XML that represents all receipts for the app and any in-app purchases. If *includeReceipt* is set to false, this string is empty.
    public static func requestAppPurchaseAsync(_ includeReceipt: Swift.Bool) throws -> WindowsFoundation_IAsyncOperation<Swift.String> {
        try COM.NullResult.unwrap(_icurrentApp.requestAppPurchaseAsync(includeReceipt))
    }

    /// Requests the purchase of an add-on (also called an in-app product or IAP). Additionally, calling this method displays the UI that is used to complete the transaction via the Microsoft Store.
    /// - Parameter productId: The product ID of the add-on to purchase.
    /// - Parameter includeReceipt: Determines if the method should return the receipts for the specified *productId.*
    /// - Returns: A string providing in-app transaction details for the provided *productId*. If *includeReceipt* is set **true**, the returned string will include a full receipt xml.
    public static func requestProductPurchaseAsync(_ productId: Swift.String, _ includeReceipt: Swift.Bool) throws -> WindowsFoundation_IAsyncOperation<Swift.String> {
        try COM.NullResult.unwrap(_icurrentApp.requestProductPurchaseAsync(productId, includeReceipt))
    }

    /// Loads the app's listing information asynchronously. 
    /// - Returns: The apps' listing information. If the method fails, it returns an **HRESULT** error code.
    public static func loadListingInformationAsync() throws -> WindowsFoundation_IAsyncOperation<WindowsApplicationModelStore_ListingInformation?> {
        try COM.NullResult.unwrap(_icurrentApp.loadListingInformationAsync())
    }

    /// Requests all receipts for the purchase of the app and any in-app products. For examples of how receipt information can be used, see Using receipts to verify product purchases.
    /// - Returns: An XML-formatted string that contains all receipt information for the purchase of the app and any in-app products.
    public static func getAppReceiptAsync() throws -> WindowsFoundation_IAsyncOperation<Swift.String> {
        try COM.NullResult.unwrap(_icurrentApp.getAppReceiptAsync())
    }

    /// Requests the receipt for the specified product ID. For examples of how receipt information can be used, see Using receipts to verify product purchases.
    /// - Parameter productId: The unique identifier for the product that you specified this identifier when you submitted the app to the Microsoft Store
    /// - Returns: An XML-formatted string that contains the receipt for the specified *productId.*
    public static func getProductReceiptAsync(_ productId: Swift.String) throws -> WindowsFoundation_IAsyncOperation<Swift.String> {
        try COM.NullResult.unwrap(_icurrentApp.getProductReceiptAsync(productId))
    }

    // MARK: Windows.ApplicationModel.Store.ICurrentAppWithConsumables members

    /// Notifies the Microsoft Store that the purchase of a consumable add-on (also called an in-app product or IAP) is fulfilled and that the user has the right to access the content.
    /// - Parameter productId: The product ID of the consumable add-on to report as fulfilled.
    /// - Parameter transactionId: The transaction ID for the purchase of the consumable add-on.
    /// - Returns: A FulfillmentResult value that indicates the fulfillment status for the consumable add-on.
    public static func reportConsumableFulfillmentAsync(_ productId: Swift.String, _ transactionId: Foundation.UUID) throws -> WindowsFoundation_IAsyncOperation<WindowsApplicationModelStore_FulfillmentResult> {
        try COM.NullResult.unwrap(_icurrentAppWithConsumables.reportConsumableFulfillmentAsync(productId, transactionId))
    }

    /// Requests the purchase of an add-on (also called an in-app product or IAP). Additionally, calling this method displays the UI that is used to complete the transaction via the Microsoft Store.
    /// - Parameter productId: The product ID of the add-on to purchase.
    /// - Returns: A PurchaseResults that contains the results of the in-app product purchase request.
    public static func requestProductPurchaseAsync(_ productId: Swift.String) throws -> WindowsFoundation_IAsyncOperation<WindowsApplicationModelStore_PurchaseResults?> {
        try COM.NullResult.unwrap(_icurrentAppWithConsumables.requestProductPurchaseWithResultsAsync(productId))
    }

    /// Requests the purchase of an add-on (also called an in-app product or IAP). Additionally, calling this method displays the UI that is used to complete the transaction via the Microsoft Store. This overload includes parameters you can use to display details for a specific offer within a large catalog of in-app purchases that is represented by a single product entry in the Store.
    /// - Parameter productId: The product ID of the add-on to purchase.
    /// - Parameter offerId: The specific in-app feature or content within the large purchase catalog represented on the Microsoft Store by the *productId.* This value correlates with the content your app is responsible for fulfilling. The Microsoft Store only uses this value to itemize the PurchaseResults.
    /// - Parameter displayProperties: The name of the app feature or content offer that is displayed to the user at time of purchase.
    /// - Returns: A PurchaseResults that contains the results of the in-app product purchase request.
    public static func requestProductPurchaseAsync(_ productId: Swift.String, _ offerId: Swift.String, _ displayProperties: WindowsApplicationModelStore_ProductPurchaseDisplayProperties?) throws -> WindowsFoundation_IAsyncOperation<WindowsApplicationModelStore_PurchaseResults?> {
        try COM.NullResult.unwrap(_icurrentAppWithConsumables.requestProductPurchaseWithDisplayPropertiesAsync(productId, offerId, displayProperties))
    }

    /// Returns a list of purchased consumable in-app products that have not been reported to the Microsoft Store as fulfilled.
    /// - Returns: When the operation completes, a list of consumable in-app products not yet reported as fulfilled is returned (UnfulfilledConsumable objects). Each item of this list provides the product ID, offer ID, and transaction ID associated with a product.
    public static func getUnfulfilledConsumablesAsync() throws -> WindowsFoundation_IAsyncOperation<WindowsFoundationCollections_IVectorView<WindowsApplicationModelStore_UnfulfilledConsumable?>?> {
        try COM.NullResult.unwrap(_icurrentAppWithConsumables.getUnfulfilledConsumablesAsync())
    }

    // MARK: Implementation details

    private static var _icurrentAppWithCampaignId_storage: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelStore_ICurrentAppWithCampaignId>? = nil

    internal static var _icurrentAppWithCampaignId: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelStore_ICurrentAppWithCampaignId> {
        get throws {
            try _icurrentAppWithCampaignId_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.ApplicationModel.Store.CurrentApp", id: CWinRT.SWRT_WindowsApplicationModelStore_ICurrentAppWithCampaignId.iid)
            }
        }
    }

    private static var _icurrentApp2Statics_storage: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelStore_ICurrentApp2Statics>? = nil

    internal static var _icurrentApp2Statics: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelStore_ICurrentApp2Statics> {
        get throws {
            try _icurrentApp2Statics_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.ApplicationModel.Store.CurrentApp", id: CWinRT.SWRT_WindowsApplicationModelStore_ICurrentApp2Statics.iid)
            }
        }
    }

    private static var _icurrentAppStaticsWithFiltering_storage: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelStore_ICurrentAppStaticsWithFiltering>? = nil

    internal static var _icurrentAppStaticsWithFiltering: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelStore_ICurrentAppStaticsWithFiltering> {
        get throws {
            try _icurrentAppStaticsWithFiltering_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.ApplicationModel.Store.CurrentApp", id: CWinRT.SWRT_WindowsApplicationModelStore_ICurrentAppStaticsWithFiltering.iid)
            }
        }
    }

    private static var _icurrentApp_storage: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelStore_ICurrentApp>? = nil

    internal static var _icurrentApp: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelStore_ICurrentApp> {
        get throws {
            try _icurrentApp_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.ApplicationModel.Store.CurrentApp", id: CWinRT.SWRT_WindowsApplicationModelStore_ICurrentApp.iid)
            }
        }
    }

    private static var _icurrentAppWithConsumables_storage: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelStore_ICurrentAppWithConsumables>? = nil

    internal static var _icurrentAppWithConsumables: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelStore_ICurrentAppWithConsumables> {
        get throws {
            try _icurrentAppWithConsumables_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.ApplicationModel.Store.CurrentApp", id: CWinRT.SWRT_WindowsApplicationModelStore_ICurrentAppWithConsumables.iid)
            }
        }
    }
}