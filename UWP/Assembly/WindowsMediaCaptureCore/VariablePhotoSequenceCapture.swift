// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Provides methods and events that enable the capture of variable photo sequences.
public final class WindowsMediaCaptureCore_VariablePhotoSequenceCapture: WindowsRuntime.WinRTImport<WindowsMediaCaptureCore_VariablePhotoSequenceCaptureProjection> {
    // MARK: Windows.Media.Capture.Core.IVariablePhotoSequenceCapture members

    /// Occurs when a frame of a variable photo sequence is captured.
    public func photoCaptured(adding handler: WindowsFoundation_TypedEventHandler<WindowsMediaCaptureCore_VariablePhotoSequenceCapture?, WindowsMediaCaptureCore_VariablePhotoCapturedEventArgs?>?) throws -> WindowsRuntime.EventRegistration {
        let _token = try _interop.add_PhotoCaptured(handler)
        return WindowsRuntime.EventRegistration(token: _token, remover: photoCaptured)
    }

    public func photoCaptured(removing token: WindowsRuntime.EventRegistrationToken) throws {
        try _interop.remove_PhotoCaptured(token)
    }

    /// Occurs when the VariablePhotoSequenceCapture object stops capturing frames for a variable photo sequence.
    public func stopped(adding handler: WindowsFoundation_TypedEventHandler<WindowsMediaCaptureCore_VariablePhotoSequenceCapture?, WindowsRuntime.IInspectable?>?) throws -> WindowsRuntime.EventRegistration {
        let _token = try _interop.add_Stopped(handler)
        return WindowsRuntime.EventRegistration(token: _token, remover: stopped)
    }

    public func stopped(removing token: WindowsRuntime.EventRegistrationToken) throws {
        try _interop.remove_Stopped(token)
    }

    /// Starts the capturing of variable photo sequence frames.
    /// - Returns: An asynchronous action.
    public func startAsync() throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.startAsync())
    }

    /// Stops the capturing of variable photo sequence frames.
    /// - Returns: An asynchronous action.
    public func stopAsync() throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.stopAsync())
    }

    /// Asynchronously releases the VariablePhotoSequenceCapture object and resources used by the capture operation.
    /// - Returns: An asynchronous action.
    public func finishAsync() throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.finishAsync())
    }

    // MARK: Windows.Media.Capture.Core.IVariablePhotoSequenceCapture2 members

    /// Updates the frame control values of the variable photo sequence.
    /// - Returns: An asynchronous action.
    public func updateSettingsAsync() throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_ivariablePhotoSequenceCapture2.updateSettingsAsync())
    }

    // MARK: Implementation details

    private var _ivariablePhotoSequenceCapture2_storage: COM.COMInterop<CWinRT.SWRT_WindowsMediaCaptureCore_IVariablePhotoSequenceCapture2>? = nil

    internal var _ivariablePhotoSequenceCapture2: COM.COMInterop<CWinRT.SWRT_WindowsMediaCaptureCore_IVariablePhotoSequenceCapture2> {
        get throws {
            try _ivariablePhotoSequenceCapture2_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsMediaCaptureCore_IVariablePhotoSequenceCapture2.iid).cast(to: CWinRT.SWRT_WindowsMediaCaptureCore_IVariablePhotoSequenceCapture2.self)
            }
        }
    }

    deinit {
        _ivariablePhotoSequenceCapture2_storage?.release()
    }
}