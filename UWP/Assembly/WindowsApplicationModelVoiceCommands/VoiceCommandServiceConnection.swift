// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// The background app service connection to **Cortana**.
public final class WindowsApplicationModelVoiceCommands_VoiceCommandServiceConnection: WindowsRuntime.WinRTImport<WindowsApplicationModelVoiceCommands_VoiceCommandServiceConnectionProjection> {
    // MARK: Windows.ApplicationModel.VoiceCommands.IVoiceCommandServiceConnection members

    /// Gets the locale for the voice command.
    /// - Returns: The locale for the voice command.
    public var language: WindowsGlobalization_Language {
        get throws {
            try COM.NullResult.unwrap(_interop.get_Language())
        }
    }

    /// Event raised when the voice command is completed and the background app service is about to be terminated.
    public func voiceCommandCompleted(adding handler: WindowsFoundation_TypedEventHandler<WindowsApplicationModelVoiceCommands_VoiceCommandServiceConnection?, WindowsApplicationModelVoiceCommands_VoiceCommandCompletedEventArgs?>?) throws -> WindowsRuntime.EventRegistration {
        let _token = try _interop.add_VoiceCommandCompleted(handler)
        return WindowsRuntime.EventRegistration(token: _token, remover: voiceCommandCompleted)
    }

    public func voiceCommandCompleted(removing token: WindowsRuntime.EventRegistrationToken) throws {
        try _interop.remove_VoiceCommandCompleted(token)
    }

    /// Retrieves the voice command that the user submitted to **Cortana** by voice or text.
    /// - Returns: The VoiceCommand.
    public func getVoiceCommandAsync() throws -> WindowsFoundation_IAsyncOperation<WindowsApplicationModelVoiceCommands_VoiceCommand?> {
        try COM.NullResult.unwrap(_interop.getVoiceCommandAsync())
    }

    /// Sends a response to **Cortana** indicating the voice command requires confirmation.
    /// - Parameter response: The response from a background app service for progress, confirmation, disambiguation, completion, or failure screens displayed on the **Cortana** canvas.
    /// - Returns: The VoiceCommandConfirmationResult object with the user's response.
    public func requestConfirmationAsync(_ response: WindowsApplicationModelVoiceCommands_VoiceCommandResponse?) throws -> WindowsFoundation_IAsyncOperation<WindowsApplicationModelVoiceCommands_VoiceCommandConfirmationResult?> {
        try COM.NullResult.unwrap(_interop.requestConfirmationAsync(response))
    }

    /// Sends a response to **Cortana** indicating the voice command returned more than one result and requires the user to select one.
    /// - Parameter response: The response from a background app service for progress, confirmation, disambiguation, completion, or failure screens displayed on the **Cortana** canvas.
    /// - Returns: The VoiceCommandDisambiguationResult object with the user's response.
    public func requestDisambiguationAsync(_ response: WindowsApplicationModelVoiceCommands_VoiceCommandResponse?) throws -> WindowsFoundation_IAsyncOperation<WindowsApplicationModelVoiceCommands_VoiceCommandDisambiguationResult?> {
        try COM.NullResult.unwrap(_interop.requestDisambiguationAsync(response))
    }

    /// Sends a response to **Cortana** indicating voice command is being processed.
    /// - Parameter response: The response from a background app service for progress, confirmation, disambiguation, completion, or failure screens displayed on the **Cortana** canvas.
    /// - Returns: An asynchronous handler called when the operation is complete.
    public func reportProgressAsync(_ response: WindowsApplicationModelVoiceCommands_VoiceCommandResponse?) throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.reportProgressAsync(response))
    }

    /// Sends a response to **Cortana** indicating the voice command has succeeded.
    /// - Parameter response: The response from a background app service for progress, confirmation, disambiguation, completion, or failure screens displayed on the **Cortana** canvas.
    /// - Returns: An asynchronous handler called when the operation is complete.
    public func reportSuccessAsync(_ response: WindowsApplicationModelVoiceCommands_VoiceCommandResponse?) throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.reportSuccessAsync(response))
    }

    /// Sends a response to **Cortana** indicating the voice command has failed.
    /// - Parameter response: The response from a background app service for progress, confirmation, disambiguation, completion, or failure screens displayed on the **Cortana** canvas.
    /// - Returns: An asynchronous handler called when the operation is complete.
    public func reportFailureAsync(_ response: WindowsApplicationModelVoiceCommands_VoiceCommandResponse?) throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.reportFailureAsync(response))
    }

    /// Sends a response to **Cortana** indicating the command should be handled by the app in the foreground.
    /// - Parameter response: The response from a background app service for progress, confirmation, disambiguation, completion, or failure screens displayed on the **Cortana** canvas.
    /// - Returns: An asynchronous handler called when the operation is complete.
    public func requestAppLaunchAsync(_ response: WindowsApplicationModelVoiceCommands_VoiceCommandResponse?) throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.requestAppLaunchAsync(response))
    }

    // MARK: Windows.ApplicationModel.VoiceCommands.IVoiceCommandServiceConnectionStatics members

    /// Retrieves a VoiceCommandServiceConnection object from the AppServiceTriggerDetails that contains info associated with the background task for the app service.
    /// - Parameter triggerDetails: Contains info associated with the background task for the app service.
    /// - Returns: The background app service connection to **Cortana**.
    public static func fromAppServiceTriggerDetails(_ triggerDetails: WindowsApplicationModelAppService_AppServiceTriggerDetails?) throws -> WindowsApplicationModelVoiceCommands_VoiceCommandServiceConnection {
        try COM.NullResult.unwrap(_ivoiceCommandServiceConnectionStatics.fromAppServiceTriggerDetails(triggerDetails))
    }

    // MARK: Implementation details

    private static var _ivoiceCommandServiceConnectionStatics_storage: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelVoiceCommands_IVoiceCommandServiceConnectionStatics>? = nil

    internal static var _ivoiceCommandServiceConnectionStatics: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelVoiceCommands_IVoiceCommandServiceConnectionStatics> {
        get throws {
            try _ivoiceCommandServiceConnectionStatics_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.ApplicationModel.VoiceCommands.VoiceCommandServiceConnection", id: CWinRT.SWRT_WindowsApplicationModelVoiceCommands_IVoiceCommandServiceConnectionStatics.iid)
            }
        }
    }
}