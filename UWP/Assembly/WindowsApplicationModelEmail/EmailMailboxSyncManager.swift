// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// The functionality described in this topic is not available to all UWP apps. As part of the store app submission process, Microsoft must approve your use of these APIs and provision your developer account before you can publish an app that uses them.
public final class WindowsApplicationModelEmail_EmailMailboxSyncManager: WindowsRuntime.WinRTImport<WindowsApplicationModelEmail_EmailMailboxSyncManagerProjection> {
    // MARK: Windows.ApplicationModel.Email.IEmailMailboxSyncManager members

    /// Gets or sets the last time the mailbox attempted to sync.
    /// - Returns: The last time the mailbox attempted to sync.
    public var lastAttemptedSyncTime: WindowsFoundation_DateTime {
        get throws {
            try _interop.get_LastAttemptedSyncTime()
        }
    }

    /// Gets or sets the last time the mailbox was successfully synced.
    /// - Returns: The last time the mailbox was successfully synced.
    public var lastSuccessfulSyncTime: WindowsFoundation_DateTime {
        get throws {
            try _interop.get_LastSuccessfulSyncTime()
        }
    }

    /// Gets or sets the sync state of the mailbox.
    /// - Returns: The sync state of the mailbox.
    public var status: WindowsApplicationModelEmail_EmailMailboxSyncStatus {
        get throws {
            try _interop.get_Status()
        }
    }

    /// Fires whenever a mailbox's sync status changes.
    public func syncStatusChanged(adding handler: WindowsFoundation_TypedEventHandler<WindowsApplicationModelEmail_EmailMailboxSyncManager?, WindowsRuntime.IInspectable?>?) throws -> WindowsRuntime.EventRegistration {
        let _token = try _interop.add_SyncStatusChanged(handler)
        return WindowsRuntime.EventRegistration(token: _token, remover: syncStatusChanged)
    }

    public func syncStatusChanged(removing token: WindowsRuntime.EventRegistrationToken) throws {
        try _interop.remove_SyncStatusChanged(token)
    }

    /// Initiates a sync of this mailbox.
    /// - Returns: A Boolean value indicating success.
    public func syncAsync() throws -> WindowsFoundation_IAsyncOperation<Swift.Bool> {
        try COM.NullResult.unwrap(_interop.syncAsync())
    }

    // MARK: Windows.ApplicationModel.Email.IEmailMailboxSyncManager2 members

    /// Gets or sets the last time the mailbox attempted to sync.
    /// - Returns: The last time the mailbox attempted to sync.
    public func lastAttemptedSyncTime(_ value: WindowsFoundation_DateTime) throws {
        try _iemailMailboxSyncManager2.put_LastAttemptedSyncTime(value)
    }

    /// Gets or sets the last time the mailbox was successfully synced.
    /// - Returns: The last time the mailbox was successfully synced.
    public func lastSuccessfulSyncTime(_ value: WindowsFoundation_DateTime) throws {
        try _iemailMailboxSyncManager2.put_LastSuccessfulSyncTime(value)
    }

    /// Gets or sets the sync state of the mailbox.
    /// - Returns: The sync state of the mailbox.
    public func status(_ value: WindowsApplicationModelEmail_EmailMailboxSyncStatus) throws {
        try _iemailMailboxSyncManager2.put_Status(value)
    }

    // MARK: Implementation details

    private var _iemailMailboxSyncManager2_storage: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelEmail_IEmailMailboxSyncManager2>? = nil

    internal var _iemailMailboxSyncManager2: COM.COMInterop<CWinRT.SWRT_WindowsApplicationModelEmail_IEmailMailboxSyncManager2> {
        get throws {
            try _iemailMailboxSyncManager2_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsApplicationModelEmail_IEmailMailboxSyncManager2.iid).cast(to: CWinRT.SWRT_WindowsApplicationModelEmail_IEmailMailboxSyncManager2.self)
            }
        }
    }

    deinit {
        _iemailMailboxSyncManager2_storage?.release()
    }
}