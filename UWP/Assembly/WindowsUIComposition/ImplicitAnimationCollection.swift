// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// A collection of animations triggered when a condition is met.
public final class WindowsUIComposition_ImplicitAnimationCollection: WindowsRuntime.WinRTImport<WindowsUIComposition_ImplicitAnimationCollectionProjection>, WindowsFoundationCollections_IIterableProtocol, WindowsFoundationCollections_IMapProtocol {
    public typealias T = WindowsFoundationCollections_IKeyValuePair<Swift.String, WindowsUIComposition_ICompositionAnimationBase?>?
    public typealias K = Swift.String
    public typealias V = WindowsUIComposition_ICompositionAnimationBase?

    // MARK: Windows.Foundation.Collections.IIterable`1<Windows.Foundation.Collections.IKeyValuePair`2<String, Windows.UI.Composition.ICompositionAnimationBase>> members

    /// Retrieves the first animation in the collection.
    /// - Returns: Retrieves the first animation in the collection.
    public func first() throws -> WindowsFoundationCollections_IIterator<WindowsFoundationCollections_IKeyValuePair<Swift.String, WindowsUIComposition_ICompositionAnimationBase?>?> {
        try COM.NullResult.unwrap(_iiterable.first())
    }

    // MARK: Windows.Foundation.Collections.IMap`2<String, Windows.UI.Composition.ICompositionAnimationBase> members

    /// The size of the collection.
    /// - Returns: The size of the collection.
    public var size: Swift.UInt32 {
        get throws {
            try _imap.get_Size()
        }
    }

    /// Retrieves the animation associated with the specified property.
    /// - Parameter key: The property to lookup.
    /// - Returns: The value, if an item with the specified key exists. Use the **HasKey** method to determine whether the key exists.
    public func lookup(_ key: Swift.String) throws -> WindowsUIComposition_ICompositionAnimationBase? {
        try _imap.lookup(key)
    }

    /// Returns a boolean indicating whether the collection contains the specified key.
    /// - Parameter key: The key to check for.
    /// - Returns: Returns true if the key is in the collection; otherwise returns false.
    public func hasKey(_ key: Swift.String) throws -> Swift.Bool {
        try _imap.hasKey(key)
    }

    /// Returns a map view of the collection.
    /// - Returns: Returns a map view of the collection.
    public func getView() throws -> WindowsFoundationCollections_IMapView<Swift.String, WindowsUIComposition_ICompositionAnimationBase?> {
        try COM.NullResult.unwrap(_imap.getView())
    }

    /// Inserts an animation into the collection.
    /// - Parameter key: The property the animation affects.
    /// - Parameter value: The animation to insert.
    /// - Returns: Boolean value indicating whether the animation was successfully inserted.
    public func insert(_ key: Swift.String, _ value: WindowsUIComposition_ICompositionAnimationBase?) throws -> Swift.Bool {
        try _imap.insert(key, value)
    }

    /// Removes the specified animation from the collection.
    /// - Parameter key: The property the animation is assigned to.
    public func remove(_ key: Swift.String) throws {
        try _imap.remove(key)
    }

    /// Removes all animations from the collection.
    public func clear() throws {
        try _imap.clear()
    }

    // MARK: Implementation details

    private var _iiterable_storage: COM.COMInterop<CWinRT.SWRT_WindowsFoundationCollections_IIterable_WindowsFoundationCollections_IKeyValuePair_String_WindowsUIComposition_ICompositionAnimationBase>? = nil

    internal var _iiterable: COM.COMInterop<CWinRT.SWRT_WindowsFoundationCollections_IIterable_WindowsFoundationCollections_IKeyValuePair_String_WindowsUIComposition_ICompositionAnimationBase> {
        get throws {
            try _iiterable_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsFoundationCollections_IIterable_WindowsFoundationCollections_IKeyValuePair_String_WindowsUIComposition_ICompositionAnimationBase.iid).cast(to: CWinRT.SWRT_WindowsFoundationCollections_IIterable_WindowsFoundationCollections_IKeyValuePair_String_WindowsUIComposition_ICompositionAnimationBase.self)
            }
        }
    }

    private var _imap_storage: COM.COMInterop<CWinRT.SWRT_WindowsFoundationCollections_IMap_String_WindowsUIComposition_ICompositionAnimationBase>? = nil

    internal var _imap: COM.COMInterop<CWinRT.SWRT_WindowsFoundationCollections_IMap_String_WindowsUIComposition_ICompositionAnimationBase> {
        get throws {
            try _imap_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsFoundationCollections_IMap_String_WindowsUIComposition_ICompositionAnimationBase.iid).cast(to: CWinRT.SWRT_WindowsFoundationCollections_IMap_String_WindowsUIComposition_ICompositionAnimationBase.self)
            }
        }
    }

    deinit {
        _iiterable_storage?.release()
        _imap_storage?.release()
    }
}