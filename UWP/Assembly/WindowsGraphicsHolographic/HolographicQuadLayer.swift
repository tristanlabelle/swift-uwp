// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Represents a retained texture for the system to display at a specified location on top of the app's primary rendered content.
public final class WindowsGraphicsHolographic_HolographicQuadLayer: WindowsRuntime.WinRTImport<WindowsGraphicsHolographic_HolographicQuadLayerProjection>, WindowsFoundation_IClosableProtocol {
    // MARK: Windows.Graphics.Holographic.IHolographicQuadLayerFactory members

    public convenience init(_ size: WindowsFoundation_Size) throws {
        self.init(_transferringRef: try COM.NullResult.unwrap(Self._iholographicQuadLayerFactory.create(size)))
    }

    public convenience init(_ size: WindowsFoundation_Size, _ pixelFormat: WindowsGraphicsDirectX_DirectXPixelFormat) throws {
        self.init(_transferringRef: try COM.NullResult.unwrap(Self._iholographicQuadLayerFactory.createWithPixelFormat(size, pixelFormat)))
    }

    // MARK: Windows.Graphics.Holographic.IHolographicQuadLayer members

    /// The pixel format for the texture that will back this quad layer.
    /// - Returns: The pixel format.
    public var pixelFormat: WindowsGraphicsDirectX_DirectXPixelFormat {
        get throws {
            try _interop.get_PixelFormat()
        }
    }

    /// The size in pixels of the texture that will back this quad layer.
    /// - Returns: The texture size.
    public var size: WindowsFoundation_Size {
        get throws {
            try _interop.get_Size()
        }
    }

    // MARK: Windows.Foundation.IClosable members

    /// Closes a quad layer, reclaiming any associated system resources.
    public func close() throws {
        try _iclosable.close()
    }

    // MARK: Implementation details

    private var _iclosable_storage: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable>? = nil

    internal var _iclosable: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable> {
        get throws {
            try _iclosable_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsFoundation_IClosable.iid).cast(to: CWinRT.SWRT_WindowsFoundation_IClosable.self)
            }
        }
    }

    deinit {
        _iclosable_storage?.release()
    }

    private static var _iholographicQuadLayerFactory_storage: COM.COMInterop<CWinRT.SWRT_WindowsGraphicsHolographic_IHolographicQuadLayerFactory>? = nil

    internal static var _iholographicQuadLayerFactory: COM.COMInterop<CWinRT.SWRT_WindowsGraphicsHolographic_IHolographicQuadLayerFactory> {
        get throws {
            try _iholographicQuadLayerFactory_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.Graphics.Holographic.HolographicQuadLayer", id: CWinRT.SWRT_WindowsGraphicsHolographic_IHolographicQuadLayerFactory.iid)
            }
        }
    }
}