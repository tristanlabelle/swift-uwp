// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Represents a single frame of audio data.
public final class WindowsMedia_AudioFrame: WindowsRuntime.WinRTImport<WindowsMedia_AudioFrameProjection>, WindowsMedia_IMediaFrameProtocol, WindowsFoundation_IClosableProtocol {
    // MARK: Windows.Media.IAudioFrameFactory members

    public convenience init(_ capacity: Swift.UInt32) throws {
        self.init(_transferringRef: try COM.NullResult.unwrap(Self._iaudioFrameFactory.create(capacity)))
    }

    // MARK: Windows.Media.IAudioFrame members

    /// Gets a AudioBuffer object that allows you to operate directly on the frame's audio data.
    /// - Parameter mode: A value indicating the access mode of the returned audio buffer.
    /// - Returns: The buffer containing audio sample data.
    public func lockBuffer(_ mode: WindowsMedia_AudioBufferAccessMode) throws -> WindowsMedia_AudioBuffer {
        try COM.NullResult.unwrap(_interop.lockBuffer(mode))
    }

    // MARK: Windows.Media.IMediaFrame members

    /// Gets or sets the duration of the audio frame.
    /// - Returns: The duration of the audio frame.
    public var duration: WindowsFoundation_IReference<WindowsFoundation_TimeSpan>? {
        get throws {
            try _imediaFrame.get_Duration()
        }
    }

    /// Gets or sets the duration of the audio frame.
    /// - Returns: The duration of the audio frame.
    public func duration(_ value: WindowsFoundation_IReference<WindowsFoundation_TimeSpan>?) throws {
        try _imediaFrame.put_Duration(value)
    }

    /// Gets the extended property set which enables getting and setting properties on the AudioFrame.
    /// - Returns: The extended properties map.
    public var extendedProperties: WindowsFoundationCollections_IPropertySet {
        get throws {
            try COM.NullResult.unwrap(_imediaFrame.get_ExtendedProperties())
        }
    }

    /// Gets or sets a value that indicates whether an audio frame is the first frame after a gap in the stream.
    /// - Returns: True if the audio frame is the first frame after a gap in the stream; otherwise, false.
    public var isDiscontinuous: Swift.Bool {
        get throws {
            try _imediaFrame.get_IsDiscontinuous()
        }
    }

    /// Gets or sets a value that indicates whether an audio frame is the first frame after a gap in the stream.
    /// - Returns: True if the audio frame is the first frame after a gap in the stream; otherwise, false.
    public func isDiscontinuous(_ value: Swift.Bool) throws {
        try _imediaFrame.put_IsDiscontinuous(value)
    }

    /// Gets a value indicating whether the audio frame is read-only.
    /// - Returns: True if the audio frame is read-only; otherwise, false.
    public var isReadOnly: Swift.Bool {
        get throws {
            try _imediaFrame.get_IsReadOnly()
        }
    }

    /// Gets or sets the relative time of the frame within the audio stream.
    /// - Returns: The relative time of the frame within the audio stream.
    public var relativeTime: WindowsFoundation_IReference<WindowsFoundation_TimeSpan>? {
        get throws {
            try _imediaFrame.get_RelativeTime()
        }
    }

    /// Gets or sets the relative time of the frame within the audio stream.
    /// - Returns: The relative time of the frame within the audio stream.
    public func relativeTime(_ value: WindowsFoundation_IReference<WindowsFoundation_TimeSpan>?) throws {
        try _imediaFrame.put_RelativeTime(value)
    }

    /// Gets or sets a timestamp that is relative to the system and is correlatable across multiple media sources on the same device.
    /// - Returns: A timestamp relative to the system.
    public var systemRelativeTime: WindowsFoundation_IReference<WindowsFoundation_TimeSpan>? {
        get throws {
            try _imediaFrame.get_SystemRelativeTime()
        }
    }

    /// Gets or sets a timestamp that is relative to the system and is correlatable across multiple media sources on the same device.
    /// - Returns: A timestamp relative to the system.
    public func systemRelativeTime(_ value: WindowsFoundation_IReference<WindowsFoundation_TimeSpan>?) throws {
        try _imediaFrame.put_SystemRelativeTime(value)
    }

    /// Gets a string indicating the type of audio data the audio frame contains.
    /// - Returns: A string indicating the type of audio data the audio frame contains.
    public var type: Swift.String {
        get throws {
            try _imediaFrame.get_Type()
        }
    }

    // MARK: Windows.Foundation.IClosable members

    /// Disposes of the object and associated resources.
    public func close() throws {
        try _iclosable.close()
    }

    // MARK: Implementation details

    private var _imediaFrame_storage: COM.COMInterop<CWinRT.SWRT_WindowsMedia_IMediaFrame>? = nil

    internal var _imediaFrame: COM.COMInterop<CWinRT.SWRT_WindowsMedia_IMediaFrame> {
        get throws {
            try _imediaFrame_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsMedia_IMediaFrame.iid).cast(to: CWinRT.SWRT_WindowsMedia_IMediaFrame.self)
            }
        }
    }

    private var _iclosable_storage: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable>? = nil

    internal var _iclosable: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable> {
        get throws {
            try _iclosable_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsFoundation_IClosable.iid).cast(to: CWinRT.SWRT_WindowsFoundation_IClosable.self)
            }
        }
    }

    deinit {
        _imediaFrame_storage?.release()
        _iclosable_storage?.release()
    }

    private static var _iaudioFrameFactory_storage: COM.COMInterop<CWinRT.SWRT_WindowsMedia_IAudioFrameFactory>? = nil

    internal static var _iaudioFrameFactory: COM.COMInterop<CWinRT.SWRT_WindowsMedia_IAudioFrameFactory> {
        get throws {
            try _iaudioFrameFactory_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.Media.AudioFrame", id: CWinRT.SWRT_WindowsMedia_IAudioFrameFactory.iid)
            }
        }
    }
}