// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Represents a compositor on which intended composition changes must be explicitly committed.
public final class WindowsUICompositionCore_CompositorController: WindowsRuntime.WinRTImport<WindowsUICompositionCore_CompositorControllerProjection>, WindowsFoundation_IClosableProtocol {
    // MARK: IActivationFactory members

    public convenience init() throws {
        self.init(_transferringRef: try Self._iactivationFactory.activateInstance(projection: WindowsUICompositionCore_CompositorControllerProjection.self))
    }

    // MARK: Windows.UI.Composition.Core.ICompositorController members

    /// Gets the compositor associated with this composition controller.
    /// - Returns: The compositor associated with this composition controller.
    public var compositor: WindowsUIComposition_Compositor {
        get throws {
            try COM.NullResult.unwrap(_interop.get_Compositor())
        }
    }

    /// Occurs when the framework needs to call Commit in order for changes to Composition objects to be reflected onscreen.
    public func commitNeeded(adding handler: WindowsFoundation_TypedEventHandler<WindowsUICompositionCore_CompositorController?, WindowsRuntime.IInspectable?>?) throws -> WindowsRuntime.EventRegistration {
        let _token = try _interop.add_CommitNeeded(handler)
        return WindowsRuntime.EventRegistration(token: _token, remover: commitNeeded)
    }

    public func commitNeeded(removing token: WindowsRuntime.EventRegistrationToken) throws {
        try _interop.remove_CommitNeeded(token)
    }

    /// Calls commit on the compositor associated with this CompositorController.
    public func commit() throws {
        try _interop.commit()
    }

    /// Ensures the previous commit was completed.
    /// - Returns: An asynchronous action.
    public func ensurePreviousCommitCompletedAsync() throws -> WindowsFoundation_IAsyncAction {
        try COM.NullResult.unwrap(_interop.ensurePreviousCommitCompletedAsync())
    }

    // MARK: Windows.Foundation.IClosable members

    /// Releases system resources that are used by the CompositorController.
    public func close() throws {
        try _iclosable.close()
    }

    // MARK: Implementation details

    private var _iclosable_storage: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable>? = nil

    internal var _iclosable: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable> {
        get throws {
            try _iclosable_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsFoundation_IClosable.iid).cast(to: CWinRT.SWRT_WindowsFoundation_IClosable.self)
            }
        }
    }

    deinit {
        _iclosable_storage?.release()
    }

    private static var _iactivationFactory_storage: COM.COMInterop<CWinRT.SWRT_IActivationFactory>? = nil

    internal static var _iactivationFactory: COM.COMInterop<CWinRT.SWRT_IActivationFactory> {
        get throws {
            try _iactivationFactory_storage.lazyInit {
                try WindowsRuntime.getActivationFactoryPointer(activatableId: "Windows.UI.Composition.Core.CompositorController", id: CWinRT.SWRT_IActivationFactory.iid)
            }
        }
    }
}