// Generated by swift-winrt
// swiftlint:disable all

import CWinRT
import WindowsRuntime
import UWP
import struct Foundation.UUID

/// Maps 2D points in a MediaFrameSource to 3D space or to a frame from a different **MediaFrameSource** using data from a DepthMediaFrame.
public final class WindowsMediaDevicesCore_DepthCorrelatedCoordinateMapper: WindowsRuntime.WinRTImport<WindowsMediaDevicesCore_DepthCorrelatedCoordinateMapperProjection>, WindowsFoundation_IClosableProtocol {
    // MARK: Windows.Media.Devices.Core.IDepthCorrelatedCoordinateMapper members

    /// Unprojects a 2D point from a MediaFrameSource to a point in 3D space, using depth information from the DepthMediaFrame from which the coordinate mapper was created with a call to TryCreateCoordinateMapper.
    /// - Parameter sourcePoint: The 2D source point within the MediaFrameSource to map.
    /// - Parameter targetCoordinateSystem: The coordinate system to which the point is unprojected.
    /// - Returns: An point in 3D space.
    public func unprojectPoint(_ sourcePoint: WindowsFoundation_Point, _ targetCoordinateSystem: WindowsPerceptionSpatial_SpatialCoordinateSystem?) throws -> WindowsFoundationNumerics_Vector3 {
        try _interop.unprojectPoint(sourcePoint, targetCoordinateSystem)
    }

    /// Unprojects an array of 2D points from a MediaFrameSource to a point in 3D space, using depth information from the DepthMediaFrame from which the coordinate mapper was created with a call to TryCreateCoordinateMapper.
    /// - Parameter sourcePoints: The array of 2D source points within the MediaFrameSource to map.
    /// - Parameter targetCoordinateSystem: The coordinate system to which the points are unprojected.
    /// - Parameter results: An array of points in 3D space.
    public func unprojectPoints(_ sourcePoints: [WindowsFoundation_Point], _ targetCoordinateSystem: WindowsPerceptionSpatial_SpatialCoordinateSystem?, _ results: [WindowsFoundationNumerics_Vector3]) throws {
        try _interop.unprojectPoints(sourcePoints, targetCoordinateSystem, results)
    }

    /// Maps a point from one MediaFrameSource to another, using depth information from the DepthMediaFrame from which the coordinate mapper was created with a call to TryCreateCoordinateMapper.
    /// - Parameter sourcePoint: The source point to be mapped to the coordinate system of a different media frame source, which is specified in the *targetCoordinateSystem* parameter.
    /// - Parameter targetCoordinateSystem: The coordinate system of the target media frame source to which the point is mapped.
    /// - Parameter targetCameraIntrinsics: The camera intrinsics describing the projection and distortion models of the media frame source to which the point is mapped.
    /// - Returns: A mapped point.
    public func mapPoint(_ sourcePoint: WindowsFoundation_Point, _ targetCoordinateSystem: WindowsPerceptionSpatial_SpatialCoordinateSystem?, _ targetCameraIntrinsics: WindowsMediaDevicesCore_CameraIntrinsics?) throws -> WindowsFoundation_Point {
        try _interop.mapPoint(sourcePoint, targetCoordinateSystem, targetCameraIntrinsics)
    }

    /// Maps an array of points from one MediaFrameSource to another, using depth information from the DepthMediaFrame from which the coordinate mapper was created with a call to TryCreateCoordinateMapper.
    /// - Parameter sourcePoints: An array of source points to be mapped to the coordinate system of a different media frame source, which is specified in the *targetCoordinateSystem* parameter.
    /// - Parameter targetCoordinateSystem: The coordinate system of the target media frame source to which the points are mapped.
    /// - Parameter targetCameraIntrinsics: The camera intrinsics describing the projection and distortion models of the media frame source to which the points are mapped.
    /// - Parameter results: An array mapped points.
    public func mapPoints(_ sourcePoints: [WindowsFoundation_Point], _ targetCoordinateSystem: WindowsPerceptionSpatial_SpatialCoordinateSystem?, _ targetCameraIntrinsics: WindowsMediaDevicesCore_CameraIntrinsics?, _ results: [WindowsFoundation_Point]) throws {
        try _interop.mapPoints(sourcePoints, targetCoordinateSystem, targetCameraIntrinsics, results)
    }

    // MARK: Windows.Foundation.IClosable members

    /// Disposes of the object and associated resources.
    public func close() throws {
        try _iclosable.close()
    }

    // MARK: Implementation details

    private var _iclosable_storage: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable>? = nil

    internal var _iclosable: COM.COMInterop<CWinRT.SWRT_WindowsFoundation_IClosable> {
        get throws {
            try _iclosable_storage.lazyInit {
                try _queryInterfacePointer(CWinRT.SWRT_WindowsFoundation_IClosable.iid).cast(to: CWinRT.SWRT_WindowsFoundation_IClosable.self)
            }
        }
    }

    deinit {
        _iclosable_storage?.release()
    }
}